<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Your Visit - GUIDAL</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        .visit-header {
            background: linear-gradient(rgba(33, 150, 243, 0.7), rgba(21, 101, 192, 0.7)), url('../images/school-visit-bg.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white;
            padding: 3rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        .visit-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .visit-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .agenda-info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 0 8px 8px 0;
        }

        .agenda-info h3 {
            margin-top: 0;
            color: #1565c0;
        }

        .agenda-info ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .agenda-info li {
            margin-bottom: 0.5rem;
            color: #333;
        }

        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        .form-section h3 {
            color: #2196f3;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            border-bottom: 2px solid #e3f2fd;
            padding-bottom: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2196f3;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .radio-option {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-option:hover {
            border-color: #2196f3;
            background: #f8f9fa;
        }

        .radio-option input[type="radio"] {
            margin-top: 0.25rem;
            width: auto;
        }

        .radio-option.selected {
            border-color: #2196f3;
            background: #e3f2fd;
        }

        .radio-text {
            flex: 1;
        }

        .radio-text strong {
            display: block;
            color: #333;
            margin-bottom: 0.25rem;
        }

        .radio-text small {
            color: #666;
            font-size: 0.9rem;
        }

        .workshop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .workshop-card {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .workshop-card:hover {
            border-color: #2196f3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
        }

        .workshop-card.selected {
            border-color: #2196f3;
            background: #e3f2fd;
        }

        .workshop-card input[type="checkbox"] {
            margin-right: 0.5rem;
            width: auto;
        }

        .workshop-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .workshop-description {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .workshop-details {
            font-size: 0.8rem;
            color: #777;
        }

        .required-field::after {
            content: " *";
            color: #f44336;
        }

        .submit-btn {
            background: #2196f3;
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 2rem;
        }

        .submit-btn:hover {
            background: #1976d2;
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .loading, .success-message, .error-message {
            display: none;
            text-align: center;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 8px;
        }

        .success-message {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            color: #2e7d32;
        }

        .error-message {
            background: #ffebee;
            border: 2px solid #f44336;
            color: #c62828;
        }

        .other-input {
            display: none;
            margin-top: 0.5rem;
        }

        .other-input.visible {
            display: block;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .workshop-grid {
                grid-template-columns: 1fr;
            }

            .visit-header h1 {
                font-size: 2rem;
            }

            .radio-group {
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <p class="foundation-presents">The International Green Tech Foundation Presents</p>
            <h1><a href="../index.html">GUIDAL</a></h1>
            <p class="subtitle">The Guide to All at <a href="https://alellagreentech.org" target="_blank" class="agt-link">Alella Green Tech</a></p>
        </div>
    </header>

    <nav class="main-nav">
        <div class="container">
            <button class="mobile-menu-toggle" aria-label="Toggle mobile menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <ul class="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="welcome.html">Welcome</a></li>
                <li><a href="science-in-action-examples.html">Science-in-Action</a></li>
                <li><a href="../index.html#activities">Activities</a></li>
                <li><a href="kits.html">Kits</a></li>
                <li><a href="follow-post.html">Follow & Share</a></li>
                <li><a href="https://alellagreentech.com/testimonials/" target="_blank">Blog</a></li>
                <li><a href="auth/login.html" class="login-btn">Login/Register</a></li>
            </ul>
        </div>
    </nav>

    <div class="visit-header">
        <div class="container">
            <h1>🎓 Plan Your Educational Visit</h1>
            <p class="visit-subtitle">Design the perfect learning experience for your students at Alella Green Tech</p>
        </div>
    </div>

    <main class="container">
        <div class="form-container">
            <!-- Visit Agenda Information -->
            <div class="agenda-info">
                <h3>📅 Typical Visit Schedule</h3>
                <ul>
                    <li><strong>10:00</strong> INTRO chat - Welcome and introduction to the site</li>
                    <li><strong>10:15</strong> START - Groups rotate between demo stations or take a general tour</li>
                    <li><strong>13:00</strong> LUNCH at the Techlounge bbq and pizza oven area - Chef's wood fire pizza! (if lunch is included)</li>
                    <li><strong>14:00</strong> HANDS ON time! Digging, planting, landscaping, etc.</li>
                    <li><strong>15:30</strong> END - Walk to the bus! Often there is time for students to enjoy romping on the natural grass field</li>
                </ul>
                <p><em>Schedule can be adapted based on your group's needs and selected format.</em></p>
            </div>

            <form id="visitPlanningForm">
                <!-- Contact Information Section -->
                <div class="form-section">
                    <h3>👋 Contact Information</h3>

                    <!-- Organizer Contact -->
                    <h4 style="color: #1976d2; margin-bottom: 1rem; font-size: 1.1rem;">Organizer Contact (Optional)</h4>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="organizerName">Organizer Name</label>
                            <input type="text" id="organizerName" name="organizerName" placeholder="Full name of trip organizer">
                        </div>
                        <div class="form-group">
                            <label for="organizerEmail">Organizer Email</label>
                            <input type="email" id="organizerEmail" name="organizerEmail" placeholder="organizer@school.edu">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="organizerPhone">Organizer Phone Number</label>
                        <input type="tel" id="organizerPhone" name="organizerPhone" placeholder="+34 123 456 789">
                    </div>

                    <!-- Lead Teacher Contact -->
                    <h4 style="color: #1976d2; margin: 2rem 0 1rem 0; font-size: 1.1rem;">Lead Teacher Contact</h4>

                    <div class="form-group">
                        <label for="leadTeacherName" class="required-field">Lead Teacher Name</label>
                        <input type="text" id="leadTeacherName" name="leadTeacherName" placeholder="Full name and position" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="leadTeacherEmail" class="required-field">Lead Teacher Email</label>
                            <input type="email" id="leadTeacherEmail" name="leadTeacherEmail" placeholder="teacher@school.edu" required>
                        </div>
                        <div class="form-group">
                            <label for="leadTeacherPhone" class="required-field">Lead Teacher Phone</label>
                            <input type="tel" id="leadTeacherPhone" name="leadTeacherPhone" placeholder="+34 123 456 789" required>
                        </div>
                    </div>

                    <!-- School Information -->
                    <h4 style="color: #1976d2; margin: 2rem 0 1rem 0; font-size: 1.1rem;">School Information</h4>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="schoolName" class="required-field">School/Organization Name</label>
                            <input type="text" id="schoolName" name="schoolName" required>
                        </div>
                        <div class="form-group">
                            <label for="country" class="required-field">Country of Origin</label>
                            <input type="text" id="country" name="country" required>
                        </div>
                    </div>
                </div>

                <!-- Visit Planning Section -->
                <div class="form-section">
                    <h3>📅 Visit Planning</h3>

                    <div class="form-group">
                        <label for="visitDates">Potential Visit Dates</label>
                        <textarea id="visitDates" name="visitDates" rows="3" placeholder="Please provide your preferred dates or time periods (e.g., 'Any time in March 2025', 'Week of April 15th', etc.)"></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="language">Preferred Language</label>
                            <select id="language" name="language">
                                <option value="">Select language</option>
                                <option value="english">English</option>
                                <option value="spanish">Spanish</option>
                                <option value="catalan">Catalan</option>
                                <option value="french">French</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="languageOther" style="opacity: 0;">Other Language</label>
                            <input type="text" id="languageOther" name="languageOther" placeholder="Specify other language" style="display: none;">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="studentCount" class="required-field">Number of Students</label>
                            <input type="number" id="studentCount" name="studentCount" min="1" max="100" required>
                        </div>
                        <div class="form-group">
                            <label for="adultCount">Number of Accompanying Adults</label>
                            <input type="number" id="adultCount" name="adultCount" min="0" max="20">
                        </div>
                    </div>
                </div>

                <!-- Visit Format Section -->
                <div class="form-section">
                    <h3>⏰ Visit Format</h3>
                    <p>Are you planning a full day or just a morning session with lunch?</p>

                    <div class="radio-group" id="visitFormatGroup">
                        <label class="radio-option">
                            <input type="radio" name="visitFormat" value="full_day_pizza_lunch">
                            <div class="radio-text">
                                <strong>Full day with pizza lunch included</strong>
                                <small>Usually the hours are 10am to 3:30pm</small>
                            </div>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="visitFormat" value="morning_no_lunch">
                            <div class="radio-text">
                                <strong>Just the morning with no lunch</strong>
                                <small>Visit ends 1300 or 1330</small>
                            </div>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="visitFormat" value="morning_with_lunch">
                            <div class="radio-text">
                                <strong>Just the morning with lunch</strong>
                                <small>We depart right after lunch (1400 or 1430)</small>
                            </div>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="visitFormat" value="other">
                            <div class="radio-text">
                                <strong>Other:</strong>
                            </div>
                        </label>
                        <input type="text" class="other-input" id="visitFormatOther" name="visitFormatOther" placeholder="Please specify your preferred format">
                    </div>
                </div>

                <!-- Educational Focus Section -->
                <div class="form-section">
                    <h3>🎯 Educational Focus</h3>
                    <p>Many schools ask for their students to see science in action (which implies an in depth tour of salient parts of our center) whilst other ask for the focus to be entirely on hands on work such as permaculture gardening or water retention landscaping. If you leave it to us, we'll have a healthy mixture of both. See and DO!</p>

                    <div class="radio-group" id="educationalFocusGroup">
                        <label class="radio-option">
                            <input type="radio" name="educationalFocus" value="seeing_real_world_science">
                            <div class="radio-text">
                                <strong>We prefer seeing real world examples that relate to things learnt about at school/homeschooling</strong>
                            </div>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="educationalFocus" value="hands_on_permaculture">
                            <div class="radio-text">
                                <strong>We prefer a very hands on visit where kids work with the land, water, plants, & soil following permaculture</strong>
                            </div>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="educationalFocus" value="balanced_mix">
                            <div class="radio-text">
                                <strong>We prefer a balanced mix of seeing things and doing things</strong>
                            </div>
                        </label>

                        <label class="radio-option">
                            <input type="radio" name="educationalFocus" value="other">
                            <div class="radio-text">
                                <strong>Other:</strong>
                            </div>
                        </label>
                        <input type="text" class="other-input" id="educationalFocusOther" name="educationalFocusOther" placeholder="Please specify your educational focus preference">
                    </div>
                </div>

                <!-- Science-in-Action Station Selection -->
                <div class="form-section">
                    <h3>🔬 Science-in-Action Station Selection</h3>
                    <p>Select the stations you'd like to include in your visit. We'll work together to determine which ones fit best with your group size, time constraints, and learning objectives.</p>

                    <div id="workshopGrid" class="workshop-grid">
                        <!-- Science stations will be loaded dynamically -->
                    </div>
                </div>

                <!-- Additional Information Section -->
                <div class="form-section">
                    <h3>💬 Additional Comments</h3>

                    <div class="form-group">
                        <label for="foodPreferences">Food Preferences/Dietary Requirements</label>
                        <textarea id="foodPreferences" name="foodPreferences" rows="2" placeholder="Any dietary restrictions, allergies, or special food requirements?"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="additionalComments">Additional Comments or Special Requests</label>
                        <textarea id="additionalComments" name="additionalComments" rows="4" placeholder="Any additional information, questions, or special requests you'd like to share?"></textarea>
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    Submit Visit Planning Request
                </button>

                <div class="loading" id="loadingMessage">
                    <p>🔄 Submitting your request...</p>
                </div>

                <div class="success-message" id="successMessage">
                    <h4>✅ Visit Request Submitted Successfully!</h4>
                    <p>Thank you for your interest in visiting Alella Green Tech. We'll review your request and contact you within 2-3 business days to confirm details and availability.</p>
                </div>

                <div class="error-message" id="errorMessage">
                    <h4>❌ Submission Error</h4>
                    <p>There was an error submitting your request. Please try again or contact us directly at <a href="mailto:visits@alellagreentech.org">visits@alellagreentech.org</a></p>
                </div>
            </form>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Alella Green Tech. <a href="../index.html">Back to GUIDAL</a></p>
        </div>
    </footer>

    <!-- Load required scripts -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        // Wait for Supabase to load before loading other scripts
        if (!window.supabase) {
            console.error('❌ Supabase library failed to load');
        } else {
            console.log('✅ Supabase library loaded successfully');
        }
    </script>
    <script src="../js/supabase-client.js"></script>
    <script>
        // Wait for supabaseClient to be available before loading visit-planning.js
        function waitForSupabaseClient() {
            if (typeof window.supabaseClient !== 'undefined') {
                console.log('✅ supabaseClient is available, loading visit-planning.js');
                const script = document.createElement('script');
                script.src = '../js/visit-planning.js';
                document.head.appendChild(script);
            } else {
                console.log('⏳ Waiting for supabaseClient...');
                setTimeout(waitForSupabaseClient, 100);
            }
        }

        // Start checking for supabaseClient
        waitForSupabaseClient();
    </script>

    <!-- Mobile Menu Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            const navMenu = document.querySelector('.nav-menu');

            if (mobileMenuToggle && navMenu) {
                mobileMenuToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                    mobileMenuToggle.classList.toggle('active');
                });

                // Close menu when clicking outside
                document.addEventListener('click', function(e) {
                    if (!e.target.closest('.main-nav')) {
                        navMenu.classList.remove('active');
                        mobileMenuToggle.classList.remove('active');
                    }
                });

                // Close menu when clicking a nav link
                const navLinks = document.querySelectorAll('.nav-menu a');
                navLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        navMenu.classList.remove('active');
                        mobileMenuToggle.classList.remove('active');
                    });
                });
            }

            // Handle radio button selection styling
            const radioGroups = document.querySelectorAll('.radio-group');
            radioGroups.forEach(group => {
                const radioOptions = group.querySelectorAll('.radio-option');
                radioOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        // Remove selected class from all options in this group
                        radioOptions.forEach(opt => opt.classList.remove('selected'));
                        // Add selected class to clicked option
                        if (this.querySelector('input[type="radio"]').checked) {
                            this.classList.add('selected');
                        }
                    });
                });
            });

            // Handle "Other" option visibility
            const languageSelect = document.getElementById('language');
            const languageOther = document.getElementById('languageOther');

            if (languageSelect && languageOther) {
                languageSelect.addEventListener('change', function() {
                if (this.value === 'other') {
                    languageOther.style.display = 'block';
                    languageOther.previousElementSibling.style.opacity = '1';
                } else {
                    languageOther.style.display = 'none';
                    languageOther.previousElementSibling.style.opacity = '0';
                }
            });
            }

            // Handle "Other" radio button inputs
            const visitFormatOther = document.getElementById('visitFormatOther');
            const educationalFocusOther = document.getElementById('educationalFocusOther');
            const visitFormatRadio = document.querySelector('input[name="visitFormat"][value="other"]');
            const educationalFocusRadio = document.querySelector('input[name="educationalFocus"][value="other"]');

            if (visitFormatRadio && visitFormatOther) {
                visitFormatRadio.addEventListener('change', function() {
                    visitFormatOther.classList.toggle('visible', this.checked);
                });
            }

            if (educationalFocusRadio && educationalFocusOther) {
                educationalFocusRadio.addEventListener('change', function() {
                    educationalFocusOther.classList.toggle('visible', this.checked);
                });
            }
        });
    </script>
</body>
</html>